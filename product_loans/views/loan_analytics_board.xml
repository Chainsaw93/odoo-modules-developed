<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Acciones -->
    <record id="action_loan_conversion_dashboard" model="ir.actions.act_window">
        <field name="name">Conversion Analytics</field>
        <field name="res_model">loan.analytics.dashboard</field>
        <field name="view_mode">kanban</field>
        <field name="target">current</field>
    </record>

    <record id="action_loan_conversion_detailed" model="ir.actions.act_window">
        <field name="name">Análisis Detallado</field>
        <field name="res_model">loan.conversion.analytics</field>
        <field name="view_mode">graph,pivot,list</field>
    </record>
    <!-- Dashboard Kanban Principal -->
    <record id="view_loan_conversion_dashboard" model="ir.ui.view">
        <field name="name">loan.analytics.dashboard.kanban</field>
        <field name="model">loan.analytics.dashboard</field>
        <field name="arch" type="xml">
            <kanban create="false" edit="false" delete="false" class="o_dashboard_kanban">
                <templates>
                    <t t-name="kanban-box">
                        <div class="container-fluid o_dashboard">
                            <div class="row">
                                <div class="col-lg-6 col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Tendencias Mensuales</h5>
                                        </div>
                                        <div class="card-body">
                                            <p>Ver gráficos detallados en Análisis</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Top Clientes</h5>
                                        </div>
                                        <div class="card-body">
                                            <p>Mejores tasas de conversión</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-lg-6 col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>Productos Estrella</h5>
                                        </div>
                                        <div class="card-body">
                                            <p>Productos con mejor performance</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5>KPIs Resumen</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row text-center">
                                                <div class="col-4">
                                                    <h3 id="kpi_loans" class="text-primary">-</h3>
                                                    <small>Préstamos</small>
                                                </div>
                                                <div class="col-4">
                                                    <h3 id="kpi_rate" class="text-success">-%</h3>
                                                    <small>Conversión</small>
                                                </div>
                                                <div class="col-4">
                                                    <h3 id="kpi_revenue" class="text-info">$-</h3>
                                                    <small>Ingresos</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Vista Graph para análisis -->
    <record id="view_loan_conversion_analytics_graph" model="ir.ui.view">
        <field name="name">loan.conversion.analytics.graph</field>
        <field name="model">loan.conversion.analytics</field>
        <field name="arch" type="xml">
            <graph string="Análisis de Conversión">
                <field name="period" type="row" interval="month"/>
                <field name="partner_id" type="col"/>
                <field name="conversion_rate" type="measure"/>
                <field name="total_loans" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- Vista Pivot -->
    <record id="view_loan_conversion_analytics_pivot" model="ir.ui.view">
        <field name="name">loan.conversion.analytics.pivot</field>
        <field name="model">loan.conversion.analytics</field>
        <field name="arch" type="xml">
            <pivot string="Pivot Conversiones">
                <field name="period" type="row" interval="quarter"/>
                <field name="partner_id" type="col"/>
                <field name="conversion_rate" type="measure"/>
                <field name="converted_value" type="measure"/>
            </pivot>
        </field>
    </record>
    <!-- Menú -->
    <record id="menu_loan_conversion_analytics" model="ir.ui.menu">
        <field name="name">Conversion Analytics</field>
        <field name="parent_id" ref="product_loans.menu_loans_reports"/>
        <field name="action" ref="action_loan_conversion_dashboard"/>
        <field name="sequence">5</field>
    </record>

</odoo>